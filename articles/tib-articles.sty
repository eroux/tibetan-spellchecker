% This .sty file contains some personal style I like, don't consider it's
% under copyright.
%
% It will most certainly work only with LuaLaTeX, but should be easily adaptable
% to XeTeX...

\RequirePackage{polyglossia}
\setmainlanguage{english}
\setotherlanguage{tibetan}

\newfontfamily\tibetanfont[Script=Tibetan,Scale=0.9]{Noto Sans Tibetan}

\newfontface\chinesefont{Noto Sans CJK SC}

\newfontfamily\libertineDisplay[Extension=.otf,
      BoldFont=LinLibertine_DR,%fake
      ItalicFont=LinLibertine_DR,%fake
      BoldItalicFont=LinLibertine_DR,%fake
      SlantedFont=LinLibertine_DR,
      BoldSlantedFont=LinLibertine_DR,%fake
      ]{LinLibertine_DR}

\frenchspacing

\defaultfontfeatures{Ligatures=TeX}
\newfontfeature{Microtype}{protrusion=default;expansion=default;}

\RequirePackage[math-style=TeX]{unicode-math}

%% Default character protrusion is too big...
\directlua{fonts.protrusions.setups.default.factor=0.5}

\setmathfont{xits-math.otf}
\RequirePackage{libertine}

% not sure it's useful
\KOMAoptions{DIV=last}

% Koma page layout
\usepackage{scrpage2}

\usepackage[hyphens]{url} % break links on hyphens too
\usepackage[breaklinks,pdfencoding=auto,unicode, bookmarks, colorlinks=false, pdfborder={0 0 0}, pdfusetitle]{hyperref}

\def\keywords#1{%
  \begin{trivlist}\item[]{\bfseries Keywords:}\ #1.\end{trivlist}%
  \hypersetup{pdfkeywords={#1}}%
}

\addtokomafont{disposition}{\rmfamily}
\addtokomafont{title}{\normalfont\libertineDisplay}
\addtokomafont{author}{\small\itshape}
\addtokomafont{date}{\small}

\RequirePackage{xcolor}
\RequirePackage{graphicx}

% head and foot separations are not really good with default KOMA options
%\usepackage{geometry}
%\geometry{headsep=5mm}

% now widow nor orphaned lines
\widowpenalty10000 \clubpenalty10000

% no matter what cost is in terms of additional lines, don't make too-long lines
\sloppy

\urlstyle{sf}

\usepackage{bookmark}

\usepackage{siunitx}
\sisetup{%
  output-decimal-marker={.},
  load-configurations=abbreviations,
  group-separator={\,}
}

\let\enumstyle\textsl
\xdef\spacearoundtables{2mm}

\usepackage{enumitem}
\setlist{nolistsep}

\usepackage{tabu}
\tabulinesep=4pt

\usepackage[bottom]{footmisc}

\def\tibbib#1{%
      \texttibetan{#1}%
}
\def\chinbib#1{%
  {\chinesefont{#1}}%
}